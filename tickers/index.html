<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>CBC World News Ticker</title>

<!-- Google Fonts – Lato -->
<link href="https://fonts.googleapis.com/css2?family=Lato:wght@400;600&display=swap" rel="stylesheet">

<style>
  :root{
    --bar-bg:#263467;
    --fg:#ffffff;
    --accent:#efb54b;
    --height:48px;
    --speed:80s;          /* ← slower scroll */
  }

  html,body{
    margin:0;
    height:var(--height);
    overflow:hidden;
    font-family:'Lato',system-ui,sans-serif;  /* ← Lato applied globally */
  }

  #wrap{background:var(--bar-bg);width:100%;height:var(--height);overflow:hidden;}

  #ticker{
    display:inline-block;
    white-space:nowrap;
    line-height:var(--height);
    animation:scroll var(--speed) linear infinite;
  }
  @keyframes scroll{from{transform:translateX(100%)}to{transform:translateX(-100%)}}

  .divider{border-left:1px solid var(--fg);margin:0 1rem;}
  .meta{font-size:.85rem;color:var(--accent)}
  .headline{
    color:var(--fg);
    font-size:1.15rem;
    font-weight:600;
    margin-left:.75rem;
    text-transform:uppercase;
    text-decoration:none;
  }
</style>
</head>

<body>
  <div id="wrap"><div id="ticker">Loading…</div></div>

  <script src="https://static.sekandocdn.net/static/feednami/feednami-client-v1.1.js"></script>
  <script>
  const FEED='https://www.cbc.ca/webfeed/rss/rss-world', OUT=document.getElementById('ticker');

  const ago=d=>{const m=Math.floor((Date.now()-d.getTime())/6e4);return m<60?m+'m':m<1440?Math.floor(m/60)+'h':Math.floor(m/1440)+'d';};

  function render(list){
    if(!list.length){OUT.textContent='(no items)';return;}
    OUT.innerHTML=list.slice(0,25).map((it,i)=>{
      const title=(it.title||'').trim(),link=(it.link||'').trim();
      if(!title||!link)return'';
      let date=new Date(it.pubDate||it.publishedDate||it.date||0);
      if(isNaN(date))date=new Date();
      let host='cbc.ca';try{host=new URL(link).hostname.replace(/^www\./,'');}catch{}
      return`${i?'<span class="divider"></span>':''}
              <span class="meta">${host}&nbsp;·&nbsp;${ago(date)}</span>
              <a class="headline" href="${link}" target="_blank" rel="noopener">${title.toUpperCase()}</a>`;
    }).join('')+OUT.innerHTML;
  }

  const fail=msg=>{console.error(msg);OUT.textContent='Feed error';};

  feednami.load(FEED).then(r=>{
      if(r.error)throw new Error(r.error);
      render(r.feed.entries);
  }).catch(()=>{
      fetch('https://api.rss2json.com/v1/api.json?rss_url='+encodeURIComponent(FEED))
        .then(r=>r.json())
        .then(j=>{if(j.status!=='ok')throw new Error(j.message);render(j.items);})
        .catch(e=>fail(e.message));
  });
  </script>
</body>
</html>
